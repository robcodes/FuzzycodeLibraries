<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Invaders</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #000;
            touch-action: none;
        }
        #gameCanvas {
            border: 1px solid #fff;
        }
        @media (min-width: 768px) and (max-width: 1024px) {
            #gameCanvas {
                width: 90vw;
                height: 90vh;
            }
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        let gameWidth, gameHeight;
        let player;

        function resizeCanvas() {
            gameWidth = Math.min(window.innerWidth * 0.9, 1024);
            gameHeight = Math.min(window.innerHeight * 0.9, 768);
            canvas.width = gameWidth;
            canvas.height = gameHeight;
            if (player) {
                player.x = gameWidth / 2;
                player.y = gameHeight - 30;
            }
        }

        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        player = {
            x: gameWidth / 2,
            y: gameHeight - 30,
            width: 50,
            height: 20,
            speed: 5
        };

        const bullets = [];
        const enemies = [];
        const enemyRows = 4;
        const enemyCols = 8;
        const enemyWidth = 40;
        const enemyHeight = 30;
        const enemyPadding = 10;
        let enemyDirection = 1;
        let score = 0;
        let gameOver = false;

        function createEnemies() {
            for (let row = 0; row < enemyRows; row++) {
                for (let col = 0; col < enemyCols; col++) {
                    enemies.push({
                        x: col * (enemyWidth + enemyPadding) + enemyPadding,
                        y: row * (enemyHeight + enemyPadding) + enemyPadding + 30,
                        width: enemyWidth,
                        height: enemyHeight
                    });
                }
            }
        }

        createEnemies();

        function drawPlayer() {
            ctx.fillStyle = '#0f0';
            ctx.fillRect(player.x - player.width / 2, player.y, player.width, player.height);
        }

        function drawBullets() {
            ctx.fillStyle = '#fff';
            bullets.forEach(bullet => {
                ctx.fillRect(bullet.x, bullet.y, 3, 10);
            });
        }

        function drawEnemies() {
            ctx.fillStyle = '#f00';
            enemies.forEach(enemy => {
                ctx.fillRect(enemy.x, enemy.y, enemy.width, enemy.height);
            });
        }

        function drawScore() {
            ctx.fillStyle = '#fff';
            ctx.font = '20px Arial';
            ctx.fillText(`Score: ${score}`, 10, 25);
        }

        function drawGameOver() {
            ctx.fillStyle = '#fff';
            ctx.font = '40px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Game Over', gameWidth / 2, gameHeight / 2);
            ctx.font = '20px Arial';
            ctx.fillText('Tap to restart', gameWidth / 2, gameHeight / 2 + 40);
        }

        function movePlayer(dx) {
            player.x += dx * player.speed;
            player.x = Math.max(player.width / 2, Math.min(gameWidth - player.width / 2, player.x));
        }

        function moveBullets() {
            for (let i = bullets.length - 1; i >= 0; i--) {
                bullets[i].y -= 5;
                if (bullets[i].y < 0) {
                    bullets.splice(i, 1);
                }
            }
        }

        function moveEnemies() {
            let moveDown = false;
            enemies.forEach(enemy => {
                enemy.x += enemyDirection * 2;
                if (enemy.x <= 0 || enemy.x + enemy.width >= gameWidth) {
                    moveDown = true;
                }
            });

            if (moveDown) {
                enemyDirection *= -1;
                enemies.forEach(enemy => {
                    enemy.y += 20;
                    if (enemy.y + enemy.height >= player.y) {
                        gameOver = true;
                    }
                });
            }
        }

        function checkCollisions() {
            for (let i = bullets.length - 1; i >= 0; i--) {
                for (let j = enemies.length - 1; j >= 0; j--) {
                    if (bullets[i] && enemies[j] &&
                        bullets[i].x >= enemies[j].x && bullets[i].x <= enemies[j].x + enemies[j].width &&
                        bullets[i].y >= enemies[j].y && bullets[i].y <= enemies[j].y + enemies[j].height) {
                        bullets.splice(i, 1);
                        enemies.splice(j, 1);
                        score += 10;
                        break;
                    }
                }
            }
        }

        function gameLoop() {
            ctx.clearRect(0, 0, gameWidth, gameHeight);

            if (gameOver) {
                drawGameOver();
            } else {
                drawPlayer();
                drawBullets();
                drawEnemies();
                drawScore();

                moveBullets();
                moveEnemies();
                checkCollisions();

                if (enemies.length === 0) {
                    gameOver = true;
                }
            }

            requestAnimationFrame(gameLoop);
        }

        function shoot() {
            bullets.push({
                x: player.x,
                y: player.y
            });
        }

        function restartGame() {
            gameOver = false;
            score = 0;
            enemies.length = 0;
            bullets.length = 0;
            createEnemies();
            player.x = gameWidth / 2;
        }

        let touchStartX = 0;

        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            touchStartX = e.touches[0].clientX;
        });

        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault();
            const touch = e.touches[0];
            const dx = touch.clientX - touchStartX;
            movePlayer(dx / 10);
            touchStartX = touch.clientX;
        });

        canvas.addEventListener('touchend', (e) => {
            e.preventDefault();
            if (gameOver) {
                restartGame();
            } else {
                shoot();
            }
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') {
                movePlayer(-1);
            } else if (e.key === 'ArrowRight') {
                movePlayer(1);
            } else if (e.key === ' ') {
                if (gameOver) {
                    restartGame();
                } else {
                    shoot();
                }
            }
        });

        gameLoop();
    </script>
</body>
</html>